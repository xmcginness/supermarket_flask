<h1>Cart</h1>

<p><a href="/">Back to products</a></p>

{% with messages = get_flashed_messages() %}
  {% if messages %}
    <ul>
      {% for m in messages %}
        <li>{{ m }}</li>
      {% endfor %}
    </ul>
  {% endif %}
{% endwith %}

{% if items %}
  <table border="1" cellpadding="6">
    <tr>
      <th>Product</th>
      <th>Price</th>
      <th>Qty</th>
      <th>Subtotal</th>
      <th>Action</th>
    </tr>

    {% for it in items %}
      <tr>
        <td>{{ it.name }}</td>
        <td>€{{ "%.2f"|format(it.price) }}</td>
        <td>{{ it.qty }}</td>
        <td>€{{ "%.2f"|format(it.subtotal) }}</td>
        <td>
          <form method="POST" action="/remove_from_cart/{{ it.id }}">
            <button type="submit">Remove</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </table>

  <h3>Total: €{{ "%.2f"|format(total) }}</h3>

  <form method="POST" action="/checkout">
    <button type="submit">Pay</button>
  </form>
{% else %}
  <p>Your cart is empty.</p>
{% endif %}
